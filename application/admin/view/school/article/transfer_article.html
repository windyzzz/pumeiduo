<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <script src="__PUBLIC__/js/jquery-1.10.2.min.js"></script>
    <script src="__PUBLIC__/js/layer/layer-min.js"></script>
    <script src="__PUBLIC__/js/global.js"></script>
</head>
<include file="public/layout"/>
<body>
<div class="adderss-add">
    <div class="ner-reac ol_box_4" style="visibility: visible; position: fixed; z-index: 500; width: 100%; height:100%">
        <div class="box-ct">
            <form action="{:U('school.article/transferArticle')}" method="post" name="form1">
                <div class="ncap-form-default">
                    <dl class="row">
                        <dt class="tit">
                            <label>所属模块</label>
                        </dt>
                        <dd class="opt">
                            <select name="module_id">
                                <option value="">所属模块</option>
                                <volist name="module" id="vo" key="k">
                                    <option value="{$key}">{$vo}</option>
                                </volist>
                            </select>
                        </dd>
                    </dl>
                    <dl class="row">
                        <dt class="tit">
                            <label>所属分类</label>
                        </dt>
                        <dd class="opt">
                            <select name="class_id">
                                <option value="">所属分类</option>
                            </select>
                        </dd>
                    </dl>
                    <div class="bot">
                        <input type="hidden" name="jump_class_id" value="{$jump_class_id}">
                        <input type="hidden" name="old_class_id" value="{$old_class_id}">
                        <input type="hidden" name="article_ids" value="{$article_ids}">
                        <input type="hidden" name="call_back" value="addModuleClassCallback">
                        <a class="ncap-btn-big ncap-btn-green" onclick="document.form1.submit()">确认提交</a>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<script type="text/javascript">
    $('select[name="module_id"]').change(function () {
        if (this.value === '') {
            $('select[name="class_id"]').html('<option value="">所属分类</option>');
        } else {
            $.ajax({
                type: "GET",
                url: "{:U('school.module/getClass')}",
                data: {module_id: this.value},
                dataType: 'json',
                success: function (data) {
                    option = '<option value="">所属分类</option>';
                    $.each(data.res, function (index, item) {
                        option = option + '<option value="' + item.id + '">' + item.name + '</option>';
                    });
                    $('select[name="class_id"]').html(option);
                },
                error: function (request) {
                    layer.msg("服务器繁忙, 请联系管理员!", {icon: 1, time: 2000});
                }
            });
        }
    });
</script>
</body>
</html>
